{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container">
    <h2>Welcome, {{ current_user.username }}</h2>

    <div class="dashboard-grid">
        <div class="card">
            <h3>Health Events Calendar</h3>
            <div class="calendar" id="unified-calendar"></div>
        </div>
    </div>
</div>

<div id="dailyLogsModal" class="modal">
    <div class="modal-content">
        <h3>Logs for <span id="selectedDate"></span></h3>
        <div id="dailyLogs">
            <div id="medicationLogs"></div>
            <div id="seizureLogs"></div>
            <div id="triggerLogs"></div>
        </div>
        <button type="button" class="btn-secondary" onclick="closeModal()">Close</button>
    </div>
</div>

<div class="dashboard-section">
    <div class="section-header">
        <h2>ASM Blood Levels</h2>
        <div class="controls">
            <select id="medication-select" onchange="updateASMPlot()">
                <option value="Levetiracetam">Levetiracetam</option>
                <option value="Lamotrigine">Lamotrigine</option>
            </select>
            <select id="timeframe-select" onchange="updateASMPlot()">
                <option value="7">Last 7 days</option>
                <option value="14">Last 14 days</option>
                <option value="30">Last 30 days</option>
            </select>
            <div class="toggle-container">
                <div class="toggle-switch" id="seizure-toggle" onclick="toggleSeizures(this)"></div>
                <span class="toggle-label">Show Seizures</span>
                <input type="checkbox" id="show-seizures" style="display: none;">
            </div>
        </div>
    </div>
    <div class="asm-plot-container">
        <canvas id="asmLevelsChart"></canvas>
    </div>
</div>
{% endblock %}