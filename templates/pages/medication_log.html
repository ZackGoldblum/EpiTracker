{% extends "base.html" %}

{% block title %}Medication Log{% endblock %}

{% block content %}
<div class="log-container">
    <div class="header-section">
        <h2>Medication Log</h2>
        <button class="btn-primary" onclick="showAddMedicationModal()">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Add Medication
        </button>
    </div>

    <div class="calendar-section">
        <div class="calendar" id="medication-calendar"></div>
    </div>

    <div class="medication-list">
        {% for med in medications %}
        <div class="medication-item">
            <div class="med-info">
                <h3>{{ med.name }}</h3>
                <p>Dosage: {{ med.dosage }}</p>
                <p>Time: {{ med.time.strftime('%I:%M %p') }}</p>
            </div>
            <div class="med-actions">
                <span class="status-badge {{ 'status-taken' if med.taken else 'status-pending' }}">
                    {{ 'Taken' if med.taken else 'Pending' }}
                </span>
                <label class="med-checkbox">
                    <input type="checkbox" 
                           {% if med.taken %}checked{% endif %}
                           onchange="updateMedicationStatus('{{ med.id }}', this)">
                    <span class="checkmark"></span>
                </label>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Add Medication Modal -->
<div id="addMedicationModal" class="modal">
    <div class="modal-content">
        <h3>Add New Medication</h3>
        <form method="POST" action="{{ url_for('add_medication') }}">
            <div class="form-group">
                <label for="med-name">Medication Name</label>
                <input type="text" id="med-name" name="name" required>
            </div>
            <div class="form-group">
                <label for="med-dosage">Dosage</label>
                <input type="text" id="med-dosage" name="dosage" required>
            </div>
            <div class="form-group">
                <label for="med-datetime">Date & Time</label>
                <input type="datetime-local" id="med-datetime" name="datetime" required>
            </div>
            <div class="modal-actions">
                <button type="submit" class="btn-primary">Add Medication</button>
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </form>
    </div>
</div>

<!-- Daily Logs Modal -->
<div id="dailyLogsModal" class="modal">
    <div class="modal-content">
        <h3>Logs for <span id="selectedDate"></span></h3>
        <div id="dailyLogs">
            <div id="medicationLogs"></div>
        </div>
        <button type="button" class="btn-secondary" onclick="closeModal()">Close</button>
    </div>
</div>
{% endblock %}