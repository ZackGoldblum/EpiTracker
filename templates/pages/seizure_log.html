{% extends "base.html" %}

{% block title %}Seizure Log{% endblock %}

{% block content %}
<div class="log-container">
    <div class="header-section">
        <h2>Seizure Log</h2>
        <button class="btn-primary" onclick="showAddSeizureModal()">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Log Seizure
        </button>
    </div>

    <div class="calendar-section">
        <div class="calendar" id="seizure-calendar"></div>
    </div>

    <div class="log-list">
        {% for seizure in seizures %}
        <div class="log-item seizure-item">
            <div class="log-date">{{ seizure.date_time.strftime('%B %d, %Y - %I:%M %p') }}</div>
            <div class="log-details">
                <div class="detail-row">
                    <span class="detail-label">Type:</span>
                    <span class="severity-badge severity-{{ seizure.type.lower() }}">{{ seizure.type }}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Severity:</span>
                    <div class="severity-meter">
                        <div class="severity-fill" style="width: '{{ seizure.severity * 10 }}%'"></div>
                        <span class="severity-text">{{ seizure.severity }}/10</span>
                    </div>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Duration:</span>
                    <span>{{ seizure.duration }} minutes</span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Add Seizure Modal -->
<div id="addSeizureModal" class="modal">
    <div class="modal-content">
        <h3>Log Seizure Event</h3>
        <form method="POST" action="{{ url_for('add_seizure') }}">
            <div class="form-group">
                <label for="seizure-datetime">Date & Time</label>
                <input type="datetime-local" id="seizure-datetime" name="date_time" required>
            </div>
            <div class="form-group">
                <label for="seizure-type">Type</label>
                <select id="seizure-type" name="type" required>
                    <option value="Tonic-Clonic">Tonic-Clonic</option>
                    <option value="Absence">Absence</option>
                    <option value="Focal">Focal</option>
                    <option value="Myoclonic">Myoclonic</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="seizure-severity">Severity (1-10)</label>
                <input type="range" id="seizure-severity" name="severity" min="1" max="10" value="5">
                <output for="seizure-severity">5</output>
            </div>
            <div class="form-group">
                <label for="seizure-duration">Duration (minutes)</label>
                <input type="number" id="seizure-duration" name="duration" min="1" required>
            </div>
            <div class="modal-actions">
                <button type="submit" class="btn-primary">Log Seizure</button>
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </form>
    </div>
</div>

<!-- Daily Logs Modal -->
<div id="dailyLogsModal" class="modal">
    <div class="modal-content">
        <h3>Logs for <span id="selectedDate"></span></h3>
        <div id="dailyLogs">
            <div id="seizureLogs"></div>
        </div>
        <button type="button" class="btn-secondary" onclick="closeModal()">Close</button>
    </div>
</div>
{% endblock %}